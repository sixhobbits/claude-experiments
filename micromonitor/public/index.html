<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MicroMonitor - System Monitoring Dashboard</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div>
                    <h1>MicroMonitor</h1>
                    <p class="subtitle">Real-time System Monitoring</p>
                </div>
                <div class="header-nav">
                    <span class="logged-in-user">Logged in as: <strong id="current-user">--</strong></span>
                </div>
            </div>
        </header>
        
        <div class="metrics-grid">
            <div class="metric-card">
                <h3>CPU Usage</h3>
                <div class="metric-value" id="cpu-usage">--</div>
                <div class="metric-unit">%</div>
            </div>
            
            <div class="metric-card">
                <h3>Memory Usage</h3>
                <div class="metric-value" id="memory-usage">--</div>
                <div class="metric-unit">%</div>
            </div>
            
            <div class="metric-card">
                <h3>Disk Usage</h3>
                <div class="metric-value" id="disk-usage">--</div>
                <div class="metric-unit">%</div>
            </div>
            
            <div class="metric-card">
                <h3>Uptime</h3>
                <div class="metric-value" id="uptime">--</div>
                <div class="metric-unit">days</div>
            </div>
        </div>
        
        <div class="charts-section">
            <div class="chart-container">
                <h3>CPU Usage History</h3>
                <canvas id="cpu-chart"></canvas>
            </div>
            
            <div class="chart-container">
                <h3>Memory Usage History</h3>
                <canvas id="memory-chart"></canvas>
            </div>
        </div>
        
        <div class="export-section">
            <h3>Data Export</h3>
            <div class="export-controls">
                <label>Export last: 
                    <select id="export-hours">
                        <option value="1">1 hour</option>
                        <option value="6">6 hours</option>
                        <option value="24" selected>24 hours</option>
                        <option value="48">48 hours</option>
                        <option value="168">7 days</option>
                    </select>
                </label>
                <button id="export-csv-btn" class="export-btn">Export to CSV</button>
                <button id="export-pdf-btn" class="export-btn">Export to PDF</button>
            </div>
        </div>
        
        <div class="retention-section">
            <h3>Data Retention Status</h3>
            <div class="retention-stats">
                <span>Total Records: <strong id="total-records">--</strong></span>
                <span>Retention Period: <strong id="retention-hours">--</strong> hours</span>
                <span>Oldest Data: <strong id="oldest-record">--</strong></span>
                <span>Archiving: <strong id="archive-status">--</strong></span>
            </div>
        </div>
        
        <div class="processes-section">
            <h3>Process Monitoring</h3>
            <div class="process-stats">
                <span>Total Processes: <strong id="total-processes">--</strong></span>
                <span>Running: <strong id="running-processes">--</strong></span>
                <span>Sleeping: <strong id="sleeping-processes">--</strong></span>
                <button id="refresh-processes-btn" class="refresh-btn">Refresh</button>
            </div>
            <div class="process-tables">
                <div class="process-table-container">
                    <h4>Top Processes by CPU</h4>
                    <table id="cpu-processes-table" class="process-table">
                        <thead>
                            <tr>
                                <th>PID</th>
                                <th>Name</th>
                                <th>CPU %</th>
                                <th>MEM %</th>
                                <th>User</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td colspan="5">Loading...</td></tr>
                        </tbody>
                    </table>
                </div>
                <div class="process-table-container">
                    <h4>Top Processes by Memory</h4>
                    <table id="memory-processes-table" class="process-table">
                        <thead>
                            <tr>
                                <th>PID</th>
                                <th>Name</th>
                                <th>MEM %</th>
                                <th>CPU %</th>
                                <th>User</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td colspan="5">Loading...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <div class="alerts-section">
            <h3>Alert Configuration</h3>
            <div class="alert-controls">
                <div class="alert-status">
                    <span>Alerting: <strong id="alert-status">--</strong></span>
                    <span>Email Alerts: <strong id="email-status">--</strong></span>
                </div>
                <button id="configure-alerts-btn" class="config-btn">Configure Alerts</button>
            </div>
            <div class="alert-history">
                <h4>Recent Alerts</h4>
                <div id="alert-history-list" class="alert-list">
                    <p class="no-alerts">No recent alerts</p>
                </div>
            </div>
        </div>
        
        <div class="webhooks-section">
            <h3>Webhook Notifications</h3>
            <div class="webhook-controls">
                <button id="configure-webhooks-btn" class="config-btn">Configure Webhooks</button>
            </div>
            <div class="webhook-history">
                <h4>Recent Webhook Activity</h4>
                <div id="webhook-history-list" class="webhook-list">
                    <p class="no-webhooks">No recent webhook activity</p>
                </div>
            </div>
        </div>
        
        <div class="api-keys-section">
            <h3>API Keys</h3>
            <div class="api-keys-controls">
                <button id="manage-api-keys-btn" class="config-btn">Manage API Keys</button>
            </div>
            <div class="api-keys-info">
                <p>API keys allow programmatic access to MicroMonitor endpoints.</p>
                <p>Use the header <code>X-API-Key: your_key_here</code> in your requests.</p>
            </div>
        </div>
        
        <div class="status-pages-section">
            <h3>Public Status Pages</h3>
            <div class="status-pages-controls">
                <button id="manage-status-pages-btn" class="config-btn">Manage Status Pages</button>
            </div>
            <div class="status-pages-info">
                <p>Create public status pages to share your service uptime with users.</p>
                <p>Each status page gets a unique URL that can be shared or embedded.</p>
            </div>
        </div>

        <div id="config-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <h2>Alert Configuration</h2>
                <div class="config-form">
                    <h3>Thresholds</h3>
                    <div class="threshold-group">
                        <label>CPU Warning (%): <input type="number" id="cpu-warning" min="0" max="100"></label>
                        <label>CPU Critical (%): <input type="number" id="cpu-critical" min="0" max="100"></label>
                    </div>
                    <div class="threshold-group">
                        <label>Memory Warning (%): <input type="number" id="memory-warning" min="0" max="100"></label>
                        <label>Memory Critical (%): <input type="number" id="memory-critical" min="0" max="100"></label>
                    </div>
                    <div class="threshold-group">
                        <label>Disk Warning (%): <input type="number" id="disk-warning" min="0" max="100"></label>
                        <label>Disk Critical (%): <input type="number" id="disk-critical" min="0" max="100"></label>
                    </div>
                    
                    <h3>Email Configuration</h3>
                    <div class="email-config">
                        <label>Enable Email Alerts: <input type="checkbox" id="email-enabled"></label>
                        <label>SMTP Host: <input type="text" id="smtp-host" placeholder="smtp.gmail.com"></label>
                        <label>SMTP Port: <input type="number" id="smtp-port" placeholder="587"></label>
                        <label>SMTP User: <input type="email" id="smtp-user" placeholder="user@example.com"></label>
                        <label>SMTP Password: <input type="password" id="smtp-pass"></label>
                        <label>From Email: <input type="email" id="email-from" placeholder="alerts@example.com"></label>
                        <label>To Email: <input type="email" id="email-to" placeholder="admin@example.com"></label>
                    </div>
                    
                    <div class="modal-buttons">
                        <button id="save-config-btn" class="save-btn">Save Configuration</button>
                        <button id="cancel-config-btn" class="cancel-btn">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="webhook-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <h2>Webhook Configuration</h2>
                <div class="webhook-form">
                    <div class="webhook-list-container">
                        <h3>Configured Webhooks</h3>
                        <div id="configured-webhooks"></div>
                        <button id="add-webhook-btn" class="add-btn">Add New Webhook</button>
                    </div>
                    
                    <div id="webhook-editor" style="display: none;">
                        <h3>Webhook Details</h3>
                        <label>Name: <input type="text" id="webhook-name" placeholder="My Webhook"></label>
                        <label>URL: <input type="url" id="webhook-url" placeholder="https://example.com/webhook"></label>
                        <label>Events: 
                            <div class="webhook-events">
                                <label><input type="checkbox" value="alert" checked> Alerts</label>
                                <label><input type="checkbox" value="test"> Test Events</label>
                            </div>
                        </label>
                        <label>Enabled: <input type="checkbox" id="webhook-enabled" checked></label>
                        <div class="webhook-buttons">
                            <button id="save-webhook-btn" class="save-btn">Save Webhook</button>
                            <button id="test-webhook-btn" class="test-btn">Test</button>
                            <button id="cancel-webhook-btn" class="cancel-btn">Cancel</button>
                        </div>
                    </div>
                    
                    <div class="modal-buttons">
                        <button id="close-webhook-modal" class="cancel-btn">Close</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="api-keys-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <h2>API Key Management</h2>
                <div class="api-keys-form">
                    <div class="api-keys-list-container">
                        <h3>Existing API Keys</h3>
                        <div id="api-keys-list"></div>
                        <button id="create-api-key-btn" class="add-btn">Create New API Key</button>
                    </div>
                    
                    <div id="api-key-creator" style="display: none;">
                        <h3>Create API Key</h3>
                        <label>Name: <input type="text" id="api-key-name" placeholder="Production API Key"></label>
                        <label>Permissions:
                            <div class="api-key-permissions">
                                <label><input type="checkbox" value="read" checked> Read Access</label>
                                <label><input type="checkbox" value="write"> Write Access</label>
                                <label><input type="checkbox" value="all"> Full Access</label>
                            </div>
                        </label>
                        <div class="api-key-buttons">
                            <button id="generate-api-key-btn" class="save-btn">Generate Key</button>
                            <button id="cancel-api-key-btn" class="cancel-btn">Cancel</button>
                        </div>
                    </div>
                    
                    <div id="api-key-display" style="display: none;">
                        <h3>API Key Created</h3>
                        <div class="api-key-warning">
                            <strong>Important:</strong> Copy this key now. You won't be able to see it again!
                        </div>
                        <div class="api-key-value">
                            <code id="generated-api-key"></code>
                            <button id="copy-api-key-btn" class="copy-btn">Copy</button>
                        </div>
                        <button id="done-api-key-btn" class="save-btn">Done</button>
                    </div>
                    
                    <div class="modal-buttons">
                        <button id="close-api-keys-modal" class="cancel-btn">Close</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="status-pages-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <h2>Public Status Pages</h2>
                <div class="config-form">
                    <h3>Create New Status Page</h3>
                    <form id="status-page-form">
                        <div class="form-group">
                            <label for="status-page-name">Service Name:</label>
                            <input type="text" id="status-page-name" placeholder="e.g., My Web Service" required>
                        </div>
                        <div class="form-group">
                            <label for="status-page-description">Description:</label>
                            <input type="text" id="status-page-description" placeholder="e.g., Production server monitoring" required>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="status-page-public" checked>
                                Make this status page public
                            </label>
                        </div>
                        <button type="submit" class="save-btn">Create Status Page</button>
                    </form>
                    
                    <h3>Existing Status Pages</h3>
                    <div id="status-pages-list" class="status-pages-list">
                        <p>Loading...</p>
                    </div>
                    
                    <div class="modal-buttons">
                        <button id="close-status-pages-modal" class="cancel-btn">Close</button>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Last updated: <span id="last-update">Never</span></p>
            <button id="analytics-btn" class="analytics-btn" onclick="window.location.href='/analytics.html'">Analytics Dashboard</button>
            <button id="logout-btn" class="logout-btn">Logout</button>
        </footer>
    </div>
    
    <!-- Feedback Button -->
    <button id="feedback-button" class="feedback-button">
        <span class="feedback-icon">💬</span>
        <span>Feedback</span>
    </button>
    
    <!-- Feedback Modal -->
    <div id="feedback-modal" class="modal">
        <div class="feedback-content">
            <div class="feedback-header">
                <h2>Send Feedback</h2>
                <button class="feedback-close" id="feedback-close">&times;</button>
            </div>
            <form id="feedback-form" class="feedback-form">
                <div>
                    <label>Email <span class="optional-label">(optional)</span></label>
                    <input type="email" id="feedback-email" placeholder="your@email.com">
                </div>
                
                <div>
                    <label>Feedback Type</label>
                    <div class="feedback-type-buttons">
                        <button type="button" class="type-button" data-type="bug">🐛 Bug Report</button>
                        <button type="button" class="type-button" data-type="feature">✨ Feature Request</button>
                        <button type="button" class="type-button active" data-type="other">💭 Other</button>
                    </div>
                </div>
                
                <div>
                    <label>Your Feedback</label>
                    <textarea id="feedback-message" placeholder="Tell us what you think..." required></textarea>
                </div>
                
                <button type="submit" class="feedback-submit">Send Feedback</button>
            </form>
            
            <div id="feedback-result"></div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="app.js"></script>
</body>
</html>